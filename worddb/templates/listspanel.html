<!DOCTYPE html>

<html>
<head>
	<meta http-equiv="content-type" content="text/ html;charset=utf-8" />
	<title>Panel of Lists</title>

	<script type="stext/javascript" src="https://raw.github.com/GBKS/Wookmark-jQuery/master/jquery.wookmark.js"></script>
	<script type="text/javascript" src="https://raw.github.com/janl/mustache.js/master/mustache.js"></script>
	<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
	<script type="text/javascript" src="/static/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/static/jquery-autoresize.js"></script>
	<script type="text/javascript" src="/static/function.js"></script>
	
	<link rel="stylesheet" type="text/css" href="/static/bootstrap/css/bootstrap.min.css"></link>
	<link rel="stylesheet" type="text/css" href="/static/global.css"></link>
	<link rel="stylesheet" type="text/css" href="/static/buttons.css"></link>
	<link rel="stylesheet" type="text/css" href="/static/main.css"></link>

</head>
<body class="lists">

	<h2>Lists Panel</h2>
	
	<div>
		<!-- ORDERBY -->
		<div class="orderby-box">
			<div><b>order by:</b>
			<select>
				<option value="created">created (oldest to newest)</option>
				<option value="modified">modified (oldest to newest)</option>
				<option value="name">list name</option>

				<script>
				var options = document.querySelectorAll('.orderby-box select option');
				for (var i=0; i < options.length; i++)
					if (options[i].value === '{{ order_by }}') {
						options[i].selected = true;
						break;
					}
				</script>
			</select>
			</div>
			<button class="styled-button red small" onClick="location.replace('?order_by='+$('.orderby-box select').val())">Order</button>
		</div>
		<!-- /ORDERBY -->
		<button class="styled-button blue" onClick="addList()">Add List</button>
	</div>


	<ul class="tags-wrapper lists-wrapper"></ul>

	<footer>
		<a href="/account">account panel</a> | <a href="/about">about this app</a> | <a href="/logout">logout</a>
	</footer>

	<div id="blackout" style="display: none"></div>


<script type="text/template" id="edit-box">
	<div id="edit-wrapper" class="styled-box">
		<form onsubmit="return false;" data-id="[[id]]">
			<input type="hidden" name="id" value="[[id]]" />
			<div title="close" class="close-button" onClick="hideEditWrapper()"></div>
			<h2 class="box-title">Edit a List:</h2>

			<div class="edit-field" data-field="label">
				<div class="edit-field-label">list name:</div>
				<textarea autofocus name="label" class="edit-field-value">[[label]]</textarea>
			</div>

			<div class="edit-field" data-field="description">
				<div class="edit-field-label">description:</div>
				<textarea name="description" class="edit-field-value">[[description]]</textarea>
			</div>

			<button id="b1" class="edit-button button blue unselectable" onClick="[[B1.func_call]]">[[B1.label]]</button>
			<button id="b2" class="edit-button button red unselectable" onClick="[[B2.func_call]]">[[B2.label]]</button>
		</form>
		<div id="blackout"></div>
	</div>
</script>

<script type="text/template" id="list-tag-html">
	<li class="list" data-label="[[label]]" data-description="[[description]]" data-id="[[id]]">
		<div tabindex="0" onClick="location.href='/lists/'+parentElement.dataset['id']" class="tag primary-tag">
			<span class="list-label">[[label]]</span>
			<button class="edit-button" onClick="event.stopPropagation(); editList(this.parentElement.parentElement); ">edit</button>
		</div>
	</li>
</script>


<script type="text/javascript">

(function () {

	window._csrf_token = '{{csrf_token}}';
	window.listpinHTML = $("script#list-tag-html")[0].innerHTML;
	window.lists = {{serialized_lists|safe}};
	window.getSortFunc = makeSortFuncGetter({
			'created':	function (obj) { return new Date(obj.created_on); },
			'modified': function (obj) { return new Date(obj.last_modified); },
		}, function (obj) { return obj.label.toLowerCase(); })

})();

</script>
</body>
</html>